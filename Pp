--[[
    SILENT V2: ULTIMATE RE-DESIGN & FIX
    - Ù†Ø¸Ø§Ù… Ø³Ø­Ø¨ Ù…ØªØ·ÙˆØ± (Draggable UI)
    - ØªØ±ØªÙŠØ¨ Ø°ÙƒÙŠ Ù„Ù„Ø®ÙŠØ§Ø±Ø§Øª (Smart Layout)
    - ÙƒØ´Ù Ø¬Ø°Ø±ÙŠ Ø´Ø§Ù…Ù„ (Root Deep Scan)
]]

local player = game:GetService("Players").LocalPlayer
local UIS = game:GetService("UserInputService")
local allRemotes = {}

--// Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©
local ScreenGui = Instance.new("ScreenGui")
ScreenGui.Name = "Silent_V2_Ultimate"
ScreenGui.ResetOnSpawn = false
ScreenGui.Parent = player:WaitForChild("PlayerGui")

--// Ø§Ù„Ø¥Ø·Ø§Ø± Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ (Main Frame)
local Main = Instance.new("Frame")
Main.Size = UDim2.new(0, 500, 0, 600)
Main.Position = UDim2.new(0.5, -250, 0.5, -300)
Main.BackgroundColor3 = Color3.fromRGB(15, 15, 20)
Main.BorderSizePixel = 0
Main.Parent = ScreenGui

-- Ø¥Ø¶Ø§ÙØ© Ø¥Ø·Ø§Ø± Ø®Ø§Ø±Ø¬ÙŠ (UI Stroke)
local UIStroke = Instance.new("UIStroke")
UIStroke.Thickness = 2
UIStroke.Color = Color3.fromRGB(0, 200, 255)
UIStroke.Parent = Main

local UICorner = Instance.new("UICorner")
UICorner.CornerRadius = UDim.new(0, 12)
UICorner.Parent = Main

--// Ø´Ø±ÙŠØ· Ø§Ù„Ø¹Ù†ÙˆØ§Ù† (Ù‚Ø§Ø¨Ù„ Ù„Ù„Ø³Ø­Ø¨)
local TitleBar = Instance.new("TextLabel")
TitleBar.Size = UDim2.new(1, 0, 0, 50)
TitleBar.Text = "  SILENT V2: ULTIMATE EDITION"
TitleBar.TextColor3 = Color3.fromRGB(255, 255, 255)
TitleBar.TextSize = 20
TitleBar.Font = Enum.Font.GothamBold
TitleBar.BackgroundColor3 = Color3.fromRGB(20, 20, 30)
TitleBar.TextXAlignment = Enum.TextXAlignment.Left
TitleBar.Parent = Main
Instance.new("UICorner", TitleBar).CornerRadius = UDim.new(0, 12)

--// Ø­Ø§ÙˆÙŠØ© Ø§Ù„Ø®ÙŠØ§Ø±Ø§Øª Ø§Ù„Ù…Ø±ØªØ¨Ø©
local ButtonsFrame = Instance.new("Frame")
ButtonsFrame.Size = UDim2.new(1, -20, 0, 160)
ButtonsFrame.Position = UDim2.new(0, 10, 0, 60)
ButtonsFrame.BackgroundTransparency = 1
ButtonsFrame.Parent = Main

local Layout = Instance.new("UIGridLayout")
Layout.CellSize = UDim2.new(0.48, 0, 0, 45)
Layout.CellPadding = UDim2.new(0.04, 0, 0.05, 0)
Layout.Parent = ButtonsFrame

local function createBtn(name, color)
    local btn = Instance.new("TextButton")
    btn.Text = name
    btn.BackgroundColor3 = color
    btn.TextColor3 = Color3.white
    btn.Font = Enum.Font.GothamBold
    btn.TextSize = 13
    btn.BorderSizePixel = 0
    Instance.new("UICorner", btn).CornerRadius = UDim.new(0, 8)
    btn.Parent = ButtonsFrame
    return btn
end

-- ØªØ±ØªÙŠØ¨ Ø§Ù„Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ø¬Ø¯ÙŠØ¯
local ScanBtn = createBtn("ğŸ” ÙØ­Øµ Ø¬Ø°Ø±ÙŠ", Color3.fromRGB(0, 120, 255))
local NilScanBtn = createBtn("ğŸ‘» ÙƒØ´Ù Ø§Ù„Ù…Ø®ÙÙŠ (Nil)", Color3.fromRGB(80, 0, 200))
local CopyAllBtn = createBtn("ğŸ“‹ Ù†Ø³Ø® ÙƒÙ„ Ø§Ù„Ù…Ø³Ø§Ø±Ø§Øª", Color3.fromRGB(50, 50, 50))
local SaveFileBtn = createBtn("ğŸ’¾ Ø­ÙØ¸ ÙÙŠ Ù…Ù„Ù (.txt)", Color3.fromRGB(0, 150, 100))
local SpamBtn = createBtn("âš¡ ÙˆØ¶Ø¹ Ø§Ù„ØªØ´ÙˆÙŠØ´", Color3.fromRGB(200, 80, 0))
local ClearBtn = createBtn("ğŸ—‘ï¸ ØªØµÙÙŠØ± Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©", Color3.fromRGB(150, 50, 50))

--// Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù†ØªØ§Ø¦Ø¬
local Scroll = Instance.new("ScrollingFrame")
Scroll.Size = UDim2.new(1, -20, 1, -240)
Scroll.Position = UDim2.new(0, 10, 0, 230)
Scroll.BackgroundColor3 = Color3.fromRGB(10, 10, 15)
Scroll.BorderSizePixel = 0
Scroll.CanvasSize = UDim2.new(0, 0, 0, 0)
Scroll.ScrollBarThickness = 3
Scroll.Parent = Main

local ListLayout = Instance.new("UIListLayout")
ListLayout.Padding = UDim.new(0, 5)
ListLayout.Parent = Scroll

--// Ù†Ø¸Ø§Ù… Ø³Ø­Ø¨ Ø§Ù„ÙˆØ§Ø¬Ù‡Ø© (Smooth Dragging)
local dragging, dragInput, dragStart, startPos
local function update(input)
    local delta = input.Position - dragStart
    Main.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)
end

TitleBar.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
        dragging = true
        dragStart = input.Position
        startPos = Main.Position
        input.Changed:Connect(function()
            if input.UserInputState == Enum.UserInputState.End then
                dragging = false
            end
        end)
    end
end)

UIS.InputChanged:Connect(function(input)
    if dragging and (input.UserInputType == Enum.UserInputType.MouseMovement or input.UserInputType == Enum.UserInputType.Touch) then
        update(input)
    end
end)

--// Ù…Ø­Ø±Ùƒ Ø§Ù„Ø¨Ø­Ø« ÙˆØ§Ù„ØªØ´ØºÙŠÙ„
local function addRemote(obj)
    if not (obj:IsA("RemoteEvent") or obj:IsA("RemoteFunction")) then return end
    if table.find(allRemotes, obj) then return end
    table.insert(allRemotes, obj)

    local row = Instance.new("Frame")
    row.Size = UDim2.new(1, -10, 0, 40)
    row.BackgroundColor3 = Color3.fromRGB(25, 25, 35)
    row.Parent = Scroll
    Instance.new("UICorner", row).CornerRadius = UDim.new(0, 6)

    local txt = Instance.new("TextLabel")
    txt.Size = UDim2.new(0.7, 0, 1, 0)
    txt.Position = UDim2.new(0, 10, 0, 0)
    txt.Text = obj.Name .. " (" .. obj.ClassName .. ")"
    txt.TextColor3 = Color3.fromRGB(200, 200, 200)
    txt.BackgroundTransparency = 1
    txt.TextXAlignment = Enum.TextXAlignment.Left
    txt.Font = Enum.Font.Gotham
    txt.TextSize = 11
    txt.Parent = row

    local copy = createBtn("Ù†Ø³Ø®", Color3.fromRGB(0, 100, 200))
    copy.Parent = row
    copy.Size = UDim2.new(0.2, 0, 0.7, 0)
    copy.Position = UDim2.new(0.78, 0, 0.15, 0)
    copy.TextSize = 10

    copy.MouseButton1Click:Connect(function()
        setclipboard(obj:GetFullName())
        copy.Text = "âœ…"
        task.wait(0.5)
        copy.Text = "Ù†Ø³Ø®"
    end)
    
    Scroll.CanvasSize = UDim2.new(0, 0, 0, ListLayout.AbsoluteContentSize.Y)
end

ScanBtn.MouseButton1Click:Connect(function()
    for _, v in pairs(game:GetDescendants()) do pcall(function() addRemote(v) end) end
end)

NilScanBtn.MouseButton1Click:Connect(function()
    if getnilinstances then
        for _, v in pairs(getnilinstances()) do pcall(function() addRemote(v) end) end
    end
end)

CopyAllBtn.MouseButton1Click:Connect(function()
    local dump = "-- [[ SILENT V2 FULL DUMP ]] --\n"
    for _, r in pairs(allRemotes) do
        dump = dump .. "game." .. r:GetFullName() .. " [" .. r.ClassName .. "]\n"
    end
    setclipboard(dump)
end)

SaveFileBtn.MouseButton1Click:Connect(function()
    if writefile then
        local dump = "-- [[ SILENT V2 FILE DUMP ]] --\n"
        for _, r in pairs(allRemotes) do dump = dump .. "game." .. r:GetFullName() .. "\n" end
        writefile("SilentV2_Dump.txt", dump)
    end
end)

ClearBtn.MouseButton1Click:Connect(function()
    allRemotes = {}
    for _, v in pairs(Scroll:GetChildren()) do if v:IsA("Frame") then v:Destroy() end end
end)

SpamBtn.MouseButton1Click:Connect(function()
    for i=1, 10 do
        for _, r in pairs(allRemotes) do
            pcall(function() if r:IsA("RemoteEvent") then r:FireServer() end end)
        end
        task.wait(0.1)
    end
end)
